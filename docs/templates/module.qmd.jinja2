{% import "macros/docstring.jinja2" as doc %}
{% import "macros/types.jinja2" as types %}
{% import "macros/navigation.jinja2" as nav %}
---
title: {% if module.name == "validmind" %}ValidMind Library{% else %}{{ module.name }}{% endif +%}
{% if module.name == "validmind" %}
aliases:
  - index.html
{% endif %}
sidebar: validmind-reference
---

{% if module.docstring %}
{{ doc.format_docstring(module.docstring) }}
{% endif %}

{% if module.members and module.name == "validmind" %}
## Python API

{% if module.members.__version__ %}
### __version__

```python
{{ module.members.__version__.value | replace("'", "") if module.members.__version__.value else module.members.__version__.members.__version__.value | replace("'", "") }}
```
{% endif %}

{# Process root-level aliases #}
{% for member in module.members | sort_members %}
{% if is_public(member, module, full_data, is_root) and member.kind == "alias" %}
{% set target = resolve_alias(member, full_data) %}
{% if target and target.docstring %}
### {{ member.name }}[()]{.muted}

{% if target.kind == "function" %}
```python
{% if target.labels and "async" in target.labels %}async {% endif %}
def {{ member.name }}(
{% for param in target.parameters %}
    {{ '**' if param.kind == 'variadic keyword' else '*' if param.kind == 'variadic positional' else '' }}{{ param.name }}{% if param.annotation %}: {{ param.annotation.name if param.annotation.cls == "ExprName" else param.annotation.left.name if param.annotation.cls == "ExprSubscript" else "" }}{% endif %}{% if param.default is not none %} = {{ param.default }}{% endif %}{% if not loop.last %},
{% endif %}
{%- endfor %}
){% if target.returns %} -> {{ types.format_module_return_type(target.returns, module, full_data) }}{% endif %}:
```
{% endif %}

{{ doc.format_docstring(target.docstring) }}
{% endif %}
{% endif %}
{% endfor %}
{% endif %}

{% if module.members %}
{# List modules #}
{% set has_modules = namespace(value=false) %}
{% for member in module.members | sort_members %}
{% if is_public(member, module, full_data, is_root) and member.kind == "module" %}
{% set has_modules.value = true %}
{% endif %}
{% endfor %}

{% if not is_root %}
{% for member in module.members | sort_members %}
{% if is_public(member, module, full_data, is_root) and member.kind == "module" %}
- [{{ member.name }}]({{ module.name }}/{{ member.name }}.qmd)
{% endif %}
{% endfor %}
{% endif %}

{# Process module-level aliases #}
{% if not is_root %}
{% for member in module.members | sort_members %}
{% if is_public(member, module, full_data, is_root) and member.kind == "alias" %}
{% set resolved = resolve_alias(member, full_data) %}
{% if resolved.kind == "function" %}
## {{ member.name }}[()]{.muted}

```python
{% if resolved.labels and "async" in resolved.labels %}async {% endif %}def {{ member.name }}(
{% for param in resolved.parameters %}
    {{ param.name }}{% if param.annotation %}: {{ param.annotation }}{% endif %}{% if param.default %} = {{ param.default }}{% endif %}{% if not loop.last %},{% endif %}
{% endfor %}
){% if resolved.returns %} -> {{ resolved.returns }}{% endif %}:
```

{% if resolved.docstring %}
{{ doc.format_docstring(resolved.docstring) }}
{% endif %}
{% endif %}
{% endif %}
{% endfor %}
{% endif %}

{# List classes and functions #}
{% for member in module.members | sort_members %}
{% if is_public(member, module, full_data, is_root) %}
{% set resolved = resolve_alias(member, full_data) %}
{% if resolved.kind == "class" %}

{% include "class.qmd.jinja2" %}
{% elif resolved.kind == "function" and member.kind != "alias" %}
{% include "function.qmd.jinja2" %}
{% endif %}
{% endif %}
{% endfor %}
{% endif %}

{# Add this section at the end, after all existing code #}
{% if module.name == "validmind" %}
## Other Members

<!-- Debug: Starting Other Members section -->
{% for member in module.members | sort_members %}
<!-- Debug: Processing {{ member.name }} -->
{% if is_public(member, module, full_data, is_root) %}
<!-- Debug: {{ member.name }} is public -->
{% set resolved = resolve_alias(member, full_data) %}
<!-- Debug: {{ member.name }} - member kind: {{ member.kind }}, resolved kind: {{ resolved.kind if resolved else 'none' }}, target path: {{ member.target_path if member.kind == "alias" else "none" }} -->
{% if member.kind == "class" or (member.kind == "alias" and member.target_path and member.target_path.split(".")[-1][0].isupper()) %}
<!-- Debug: Including class template for {{ member.name }} -->
{% include "class.qmd.jinja2" with context %}
{% endif %}
{% endif %}
{% endfor %}
{% endif %}
